<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Thumbnails Example</title>
    <link rel="stylesheet" href="font-awesome.min.css">
    <link rel="stylesheet" href="thumbnails.css">
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }
    </style>

    <script type="text/javascript" src="uncharted.thumbnails.dependencies.js"></script>
    <script type="text/javascript" src="uncharted.thumbnails.js"></script>
    <script type="text/javascript" src="sampledata.js"></script>
</head>
<body>

<div id="thumbnails-parent" style="top: 0; bottom: 45px; position: absolute; width: 100%; overflow: hidden; z-index: 0">
    <div class="thumbnails-panel" ></div>
</div>
<div id="interactions" style="background: #fff; text-align: center; height: 45px; bottom: 0; position: absolute; z-index: 1">
    <button id="applyFilter" style="font-weight:bold;">APPLY ID ARRAY FILTER</button>
    <button id="applyNewFilter" style="font-weight:bold;">APPLY SINGLE ID FILTER</button>
    <button id="applyFunctionFilter" style="font-weight:bold;">APPLY FUNCTION FILTER</button>
    <button id="applyNullFilter" style="font-weight:bold;">APPLY NULL FILTER</button>
    <button id="highlight" style="font-weight:bold;">HIGHLIGHT</button>
    <button id="highlightSomethingElse" style="font-weight:bold;">HIGHLIGHT SOMETHING ELSE</button>
    <button id="highlightMultiple" style="font-weight:bold;">HIGHLIGHT MULTIPLE</button>
    <button id="unhighlight" style="font-weight:bold;">UNHIGHLIGHT</button>
    <button id="loadmore" style="font-weight:bold;">LOAD MORE</button>
    <button id="toggleDisplayMode" style="font-weight:bold;">TOGGLE DISPLAY MODE</button>
    <button id="toggleBlur" style="font-weight:bold;">TOGGLE IMAGE BLUR</button>
</div>

<script type="text/javascript">
    var thumbnailsConfig = {
        outlineReader: {
            onLoadUrl: function(/* readerUrl */) {
                return new Promise(function (resolve) {
                    setTimeout(function () {
                        resolve({
                            title: 'Lorem ipsum',
                            content: '<div class="zn-body__read-all"><p class="zn-body__paragraph">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam diam massa, consequat non dolor ac, dignissim elementum est. Quisque non nulla odio. Phasellus urna diam, condimentum blandit mi ac, euismod faucibus libero. Maecenas nec purus non mauris volutpat lacinia et id leo. Quisque quis maximus dolor. Morbi placerat sagittis tristique. Duis rhoncus sed urna sed dictum.    </p><p>    Curabitur rhoncus viverra ex, in mollis quam. Vivamus ultrices orci id mi pretium convallis. Nunc venenatis finibus mauris, eget gravida nunc porta ut. Praesent aliquet cursus orci quis auctor. Vivamus aliquet, metus pharetra egestas vulputate, sem libero molestie dui, non lobortis enim mi tincidunt lorem. Aenean nec enim ac libero vestibulum pellentesque vel ut elit. Aenean ac neque vel eros tincidunt sodales. Praesent lacinia ex urna, vel rutrum purus rhoncus et. Nulla finibus elit sit amet mi dictum interdum. Etiam quis neque felis. Etiam malesuada finibus blandit. Suspendisse condimentum, tortor ut egestas varius, sem lectus lacinia augue, at vulputate lacus elit ac elit. Interdum et malesuada fames ac ante ipsum primis in faucibus. Etiam gravida eleifend erat, id ultricies lorem auctor in. Ut euismod risus at eros ullamcorper interdum.</p><p>Integer accumsan gravida congue. Etiam elementum ultricies consequat. Maecenas ac ipsum tincidunt, fringilla leo at, molestie ipsum. Mauris a ante eros. Morbi placerat nisi et nulla congue, at finibus nibh finibus. Nunc malesuada, metus eu condimentum sodales, sem ex dapibus arcu, ut consequat leo orci at ex. Donec posuere purus vulputate, vehicula purus sit amet, convallis est. Sed egestas tincidunt laoreet. Cras facilisis ultricies arcu id rhoncus. Fusce luctus leo tortor, eu faucibus elit posuere eget. Nam mattis rhoncus nulla, in mollis velit congue ut.</p><p>Aenean quis lobortis arcu. Suspendisse tincidunt tellus id felis interdum convallis. Sed placerat elit quis urna auctor, vel hendrerit nulla rhoncus. Mauris non gravida ex, ac tempor magna. Proin condimentum elementum risus ut fringilla. In tortor turpis, viverra vel eros a, ullamcorper semper nisl. Etiam pulvinar aliquam dolor viverra facilisis. Nulla facilisi. Proin sed euismod diam. Cras finibus, magna sed porta molestie, mauris libero vestibulum erat, ut aliquam risus purus sit amet mi. Curabitur vel nulla sem. Aenean in aliquet felis. Nulla nec justo ac odio elementum tristique at accumsan felis. Nullam tincidunt suscipit suscipit. Praesent et tempus velit, sit amet condimentum est. Interdum et malesuada fames ac ante ipsum primis in faucibus.</p><p>Mauris euismod pretium hendrerit. Aliquam dapibus vehicula magna, a convallis orci luctus sed. Nullam tristique diam diam, quis sollicitudin dolor porta eget. Morbi lobortis neque vitae metus cursus, id tincidunt nulla semper. Pellentesque luctus fermentum turpis, eu ullamcorper diam ultrices et. Aliquam sollicitudin dui a dolor ultricies viverra. Aliquam leo metus, molestie et ultricies et, consectetur sit amet dui. Nunc pellentesque dictum ipsum, eleifend tempus turpis fringilla a. Nulla id aliquet mauris. Fusce tortor diam, imperdiet sed posuere sit amet, porta ac sapien. Maecenas varius euismod turpis eu vehicula. Proin aliquet mauris vitae ligula auctor aliquet nec et lorem. Mauris dignissim, augue nec fringilla dapibus, dolor magna euismod risus, at placerat mauris magna lobortis nibh. Ut porta tincidunt augue.</p></p><div class="el__leafmedia el__leafmedia--raw-html"><a href="https://twitter.com/CNNpolitics" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @CNNpolitics</a> </div></div>',
                            author: 'Aliquam dapibus',
                            source: 'source',
                            sourceUrl: 'sourceUrl',
                            figureImgUrl: 'http://i2.cdn.turner.com/cnnnext/dam/assets/150928104501-obama-un-general-assembly-address-russia-ukraine-crimea-00003513-large-169.jpg',
                            figureCaption: 'Suspendisse tincidunt tellus id felis interdum convallis',
                            lastupdatedon: 'Sep. 28, 2015',
                        });
                    }, 500);
                });
            },
        },
    };
    var id = 1;
    var entitiesRepositionDelay = 500;
    var inlineDisplayMode = false;
    var isBlur = false;
    var thumbnails = new Uncharted.Thumbnails({
        container: $('.thumbnails-panel'),
        config: thumbnailsConfig
    });

    thumbnails.on('thumbnail:click', function (thumbnailData) {
        console.log('thumbnail clicked id: '+ thumbnailData.id);
    });
    thumbnails.on('thumbnail:expand readerview:open', function (thumbnailData) {
        console.log('Reader Opened Id: ' + thumbnailData.id);
    });
    thumbnails.on('thumbnail:shrink readerview:close', function (thumbnailData) {
        console.log('Reader Closed Id: ' + thumbnailData.id);
    });
    thumbnails.on('outlineReader:contentLoad', function (readerContentUrl) {
        console.log(readerContentUrl);
    });

    var centerExpandedThumbnail = function () {
        thumbnails.centerInlineThumbnail(_.find(thumbnails._thumbnailItems, function (thumbnail) { return thumbnail.isExpanded; }));
    };
    thumbnails.loadData(JSON.parse(JSON.stringify(thumbnailsSampleData)).map(function (data) { data.id = id++; return data; }));

    $("#applyFilter").on("click", function() {
        thumbnails.filter([1, 5, 7]);
        centerExpandedThumbnail();
    });
    $("#applyNewFilter").on("click", function() {
        thumbnails.filter(4);
        centerExpandedThumbnail();
    });
    $("#applyFunctionFilter").on("click", function() {
        thumbnails.filter(function(outline) {
            return outline.rank > 7;
        });
        centerExpandedThumbnail();
    });
    $("#applyNullFilter").on("click", function() {
        thumbnails.filter(undefined);
        centerExpandedThumbnail();
    });
    $("#highlight").on("click", function() {
        thumbnails.highlight({"name":"Washington DC","type":"place"});
    });
    $("#highlightSomethingElse").on("click", function() {
        thumbnails.highlight({"name":"Donald Trump","type":"person"});
    });
    $("#highlightMultiple").on("click", function() {
        thumbnails.highlight([{"name":"Washington DC","type":"place"}, {"name":"Donald Trump","type":"person"}]);
    });
    $("#unhighlight").on("click", function() {
        thumbnails.highlight(undefined);
    });
    $("#loadmore").on("click", function() {
        thumbnails.loadData(JSON.parse(JSON.stringify(thumbnailsSampleData)).map(function (data) { data.id = id++; return data; }), true);
    });
    $("#toggleDisplayMode").on("click", function() {
        inlineDisplayMode = !inlineDisplayMode;
        thumbnails.toggleInlineDisplayMode(inlineDisplayMode);
    });
    $("#toggleBlur").on("click", function() {
        isBlur = !isBlur;
        thumbnails.enableBlur(isBlur);
    });
    $(window).resize(_.debounce(function () {
        thumbnails.resize();
    }, entitiesRepositionDelay));
</script>
</body>
</html>
